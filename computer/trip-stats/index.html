<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LCARS</title>
  <link rel="stylesheet" href="css/lcars.min.css">
  <style>
    @font-face {
        font-family: lcars; src: url('font/lcars.otf');
    }
    
    html, body {
        background: black;
        font-family: lcars;
        width: 800px; 
        height: 480px;
        border: solid 1px #000;
    }

    .absolute {
        position: absolute;
    }

    .black {
        color: black;
    }

    .background-text {
        font-size: 25px;
    }

    .medium-text {
        font-size: 40px;
    }

    .medium-large-text {
        font-size: 55px;
    }

    .large-text {
        font-size: 60px;
    }

    .time-text {
        font-size: 90px;
    }
    
    .light-purple {
         color: #F2B3FF;
    }
    
    .light-red {
         color: #FFB3C0;
    }
  </style>
  <script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
</head>
<body>
    <!-- DATA ELEMENTS -->
    <span class="absolute black background-text" style="top: 0px; left: 270px;">WIFI (<span id="internetConnected">offline</span>)</span>
    <span class="absolute black background-text" style="top: 0px; left: 450px;"><span id="weatherSummary"></span></span>
    <h3 class="lcars-red-color absolute medium-large-text" style="top: 350px; left: 270px; font-weight: 100;"><span id="speed">0</span> MPH</h3>
    <span class="lcars-tan-color absolute" style="top: 40px;  left: 370px;">EXTERIOR</span>
    <strong class="medium-large-text absolute light-purple" style="top: 55px; left: 370px;"><span id="outsideTemp">0</span>&deg;F / <span id="outsideHumidity">0</span>%</strong>
    <span class="lcars-tan-color absolute" style="top: 40px; left: 540px;">INTERIOR</span>
    <strong class="medium-large-text absolute light-red" style="top: 55px; left: 540px;"><span id="insideTemp">0</span>&deg;F / <span id="insideHumidity">0</span>%</strong>
    <span class="lcars-tan-color absolute" style="top: 115px; left: 370px;">STATISTICS</span>
    <span class="lcars-tan-color absolute" style="top: 150px; left: 100px;">HEADING</span>
    <span class="lcars-tan-color absolute" style="top: 150px; left: 100px;"><img id="compass" src="img/compass.png" style="width:220px;"/></span>
    <strong class="absolute lcars-purple-color medium-text" style="top: 360px; left: 105px;"><span id="tracking"></span></strong>
    <table class="absolute large-text" style="left: 370px; top: 130px; width: 40%;">
        <tr>
            <td class="lcars-blue-color" style="width: 170px;">DRIVING</td>
            <td class="lcars-blue-color"><span id="drivingTime">0 MIN</span></td>
        </tr>
        <tr>
            <td class="lcars-red-color" style="width: 170px;">TRAFFIC</td>
            <td class="lcars-red-color"><span id="inTrafficTime">0 MIN</span></td>
        </tr>
        <tr>
            <td class="lcars-purple-color" style="width: 170px;">AVG SPEED</td>
            <td class="lcars-purple-color"><span id="averageSpeed">0</span> MPH</td>
        </tr>
    </table>
    
    <i class="medium-text absolute" style="left: 380px; top: 320px; width: 350px; height: 35px; overflow: hidden;"><span id="weatherNextHour" ></span></i>
    <div class="absolute medium-text" style="left: 10px; top: 430px; width: 800px; height: 45px;  overflow: hidden;"><div id="phoneMessage"></div></div>
    <span style="font-size: 25px; position: absolute; color: black; top: 400px; left: 250px;">Altitude <span id="altitude">0</span> ft</span>
    <span style="font-size: 25px; position: absolute; color: black; top: 400px; left: 380px;"><span id="latitude">0</span> / <span id="longitude">0</span></span>
    <span style="font-size: 25px; position: absolute; color: black; position: absolute; top: 400px; left: 165px;">CLB <span id="climb">0</span></span>
    <span style="font-size: 25px; position: absolute; color: black; position: absolute; top: 400px; left: 612px;">TRK <span id="track">0.0</span></span> 

  <!-- LCARS INTERFACE -->
  <div class="lcars-container" style="padding:0; margin:0;">
    <div class="lcars-row spaced">
      <div class="lcars-column u-1-8 lcars-elbow left bottom lcars-orange-bg"></div>
      <div class="lcars-column u-6-8 lcars-divider lcars-orange-tan-divide">
        <div class="lcars-row">
          
          <div class="lcars-column u-1-2">                  
          <span class="absolute lcars-tan-color" style="top: 35px;">SYSTEM TIME</span>
          <h1 class="absolute time-text" style="top: 42px;"><span id="time">00:00PM</span></h1>
          </div>
          <div class="lcars-column u-1-2">
          </div>
        </div>
      </div>
      <div class="lcars-column u-1-8 lcars-elbow right bottom lcars-tan-bg"></div>
    </div>
    <div class="lcars-row">
      <div class="lcars-column u-1-8">
        <ul class="lcars-menu">
          <li class="lcars-orange-bg"></li>
          <li class="lcars-orange-bg tall large-gap"></li>
          <li class="lcars-tan-bg"></li>
          <li class="lcars-tan-bg tall"></li>
          <li class="lcars-tan-bg"></li>
        </ul>
      </div>
      <div class="lcars-column u-6-8">
        <div class="lcars-row">
          <div class="lcars-column u-1-2">
            &nbsp;
          </div>
          <div class="lcars-column u-1-2">
            &nbsp;
          </div>
        </div>
      </div>
      <div class="lcars-column u-1-8">
        <ul class="lcars-menu right">
          <li class="lcars-tan-bg">&nbsp;</li>
          <li class="lcars-tan-bg tall large-gap">&nbsp;</li>
          <li class="lcars-orange-bg">&nbsp;</li>
          <li class="lcars-orange-bg tall" style="position: relative;"><span style="font-size: 20px; position: absolute; bottom: 0; font-weight: 100;">WIND <span id="windSpeed">0</span> MPH<br/>RAIN <span id="precipProbability">0</span>%</span></li>
          <li class="lcars-orange-bg"><span style="font-size: 20px; font-weight: 100;">INT <span id="precipIntensity"></span></span></li>
        </ul>
      </div>
    </div>
    <div class="lcars-row spaced">
      <div class="lcars-column u-1-8 lcars-elbow left top lcars-tan-bg"></div>
      <div class="lcars-column u-6-8 lcars-divider bottom lcars-tan-orange-divide">
        <div class="lcars-row">
          <div class="lcars-column u-1-2"></div>
          <div class="lcars-column u-1-2"></div>
        </div>
      </div>
      <div class="lcars-column u-1-8 lcars-elbow right top lcars-orange-bg"></div>
    </div>
  </div>
  
  <!-- 
    TODO
    <span id="drivingTimes1">--</span>
    <span id="drivingTimes2">--</span>
    <span id="drivingTimes3">--</span>
    <span id="inTrafficTimes1">--</span>
    <span id="inTrafficTimes2">--</span>
    <span id="inTrafficTimes3">--</span>
    <span id="averageSpeeds1">--</span> mph
    <span id="averageSpeeds2">--</span> mph
    <span id="averageSpeeds3">--</span> mph
    <span id="milesTravelled1">--</span>
    <span id="milesTravelled2">--</span>
    <span id="milesTravelled3">--</span>
    <span id="averageAltitude1">--</span> ft
    <span id="averageAltitude2">--</span> ft
    <span id="averageAltitude3">--</span> ft
    <span id="localeInfo">--</span>
    <span id="currentTripTime">--</span>
  -->
  
 <script type="text/javascript">
 
     // each second update the LCARS UI with the new data 
      $(document).ready(function() {
          setInterval(function() {
            $.get( "/computer/TripStats.py", function( data ) {
                var data = JSON.parse(data);
                console.log(data);
                
                // rotate the compass the number of degress
                rotateCompass( data.track , data.speed );
                
                // populate inside temp/humidity
                $( "#insideHumidity" ).html( data.insideHumidity );            
                $( "#insideTemp" ).html( data.insideTemp );

                // populate known GPS data
                $( "#speed" ).html( data.speed );
                
                // if the speed is above 5 we can accurately display the direction
                if (data.speed > 5) {
                    $( "#tracking" ).html( data.tracking );
                }
                
                $( "#track" ).html( data.track );
                $( "#climb" ).html( data.climb );
                $( "#latitude" ).html( data.latitude );
                $( "#longitude" ).html( data.longitude );
                $( "#altitude" ).html( data.altitude );
                
                // check that the internet is connected                
                var internetConnected = data.internetConnected;
                if (internetConnected == "ok") {
                    $( "#internetConnected" ).html( "connected" );
                    $( "#time" ).html( data.time );
                } else {
                    $( "#internetConnected" ).html( "offline" );
                    $( "#phoneMessage" ).html( " - Internet Offline - " );
                    $( "#time" ).html( "00:00PM" );
                }

                // populate known weather info
                $( "#weatherNextHour" ).html( data.weatherNextHour.substring(0, 30) );
                $( "#weatherSummary" ).html( data.weatherSummary );
                $( "#windSpeed" ).html( data.windSpeed );                
                $( "#outsideTemp" ).html( data.outsideTemp );
                $( "#outsideHumidity" ).html( data.outsideHumidity );
                $( "#precipIntensity" ).html( data.precipIntensity );
                $( "#precipProbability" ).html( data.precipProbability ); 
                                
                // current trip stats
                $( "#averageSpeed" ).html( data.averageSpeed );
                $( "#drivingTime" ).html( data.drivingTime );
                $( "#inTrafficTime" ).html( data.inTrafficTime );
                $( "#currentTripTime" ).html( data.tripMilesTravelled ); 
                
                // show phone message if one is present and we're connected to the internet
                if (internetConnected == 'ok') {
                    if (data.phoneMessage != '') {
                        $( "#phoneMessage" ).html( data.phoneMessage );
                    } else {
                        $( "#phoneMessage" ).html( "" );
                    }                
                }
                
                // populate known local info
                //$( "#localeInfo" ).html( data.localeInfo );
                
                // populate altitude history
                // $( "#averageAltitude1" ).html( data.averageAltitude[1] );
                // $( "#averageAltitude2" ).html( data.averageAltitude[2] );
                // $( "#averageAltitude3" ).html( data.averageAltitude[3] );
            
                // populate speed history
                // $( "#averageSpeeds1" ).html( data.averageSpeeds[1] );
                // $( "#averageSpeeds2" ).html( data.averageSpeeds[2] );            
                // $( "#averageSpeeds3" ).html( data.averageSpeeds[3] );
                
                // populate driving times
                // $( "#drivingTimes1" ).html( data.drivingTimes[1] );
                // $( "#drivingTimes2" ).html( data.drivingTimes[2] );
                // $( "#drivingTimes3" ).html( data.drivingTimes[3] );

                // populate traffic times
                // $( "#inTrafficTimes1" ).html( data.inTrafficTimes[1] );
                // $( "#inTrafficTimes2" ).html( data.inTrafficTimes[2] );
                // $( "#inTrafficTimes3" ).html( data.inTrafficTimes[3] );
                
                // populate miles travelled
                //$( "#milesTravelled1" ).html( data.milesTravelled[1] );
                //$( "#milesTravelled2" ).html( data.milesTravelled[2] );
                //$( "#milesTravelled3" ).html( data.milesTravelled[3] );
            });
          }, 1000);
      });
      
     // rotate the compass image by arbitrary degrees but only if we're actually moving for correct GPS readings
     function rotateCompass(deg, speed) {
        if (speed > 5) {
            deg = -deg;
            $( "#compass" ).css({"-webkit-transform": "rotate("+deg+"deg)","-moz-transform": "rotate("+deg+"deg)","transform": "rotate("+deg+"deg)"});
        }
     }
  </script>
</body>
</html>
