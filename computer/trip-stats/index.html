<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LCARS</title>
  <link rel="stylesheet" href="css/lcars.min.css">
  <link rel="stylesheet" href="css/carcomputer.css">
  <script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
</head>
<body id="car-computer">

    <!-- DATA ELEMENTS -->
    <span class="absolute black background-text" style="top: 0px; left: 270px;">WIFI (<span id="internetConnected">offline</span>)</span>
    <span class="lcars-tan-color absolute" style="top: 40px;  left: 370px;">EXTERIOR</span>
    <strong class="medium-large-text absolute lcars-purple-color" style="top: 55px; left: 370px;"><span id="outsideTemp">0</span>&deg;F/<span id="outsideHumidity">0</span>%</strong>
    <span class="lcars-tan-color absolute" style="top: 40px; left: 540px;">INTERIOR</span>
    <strong class="medium-large-text absolute lcars-red-color" style="top: 55px; left: 540px;"><span id="insideTemp">0</span>&deg;F/<span id="insideHumidity">0</span>%</strong>
    <span class="absolute black background-text" style="top: 0px; left: 450px;"><span id="weatherSummary"></span></span>
    
    <div id="heading-info" style="display:block">
        <span class="lcars-tan-color absolute" style="top: 115px; left: 370px;">STATISTICS</span>
        <span class="lcars-tan-color absolute" style="top: 150px; left: 100px;">HEADING</span>
        <span class="lcars-tan-color absolute" style="top: 150px; left: 100px;"><img id="compass" src="img/compass.png" style="width:220px;"/></span>
        <strong class="absolute lcars-purple-color medium-text" style="top: 360px; left: 105px;"><span id="tracking"></span></strong>
         <h3 class="lcars-red-color absolute medium-large-text" style="top: 350px; left: 270px; font-weight: 100;"><span id="speed">0</span> MPH</h3>
         <i class="medium-text absolute" style="left: 380px; top: 320px; width: 350px; height: 35px; overflow: hidden;"><span id="weatherNextHour" ></span></i>
    </div>

    <!-- 'Up' button pressed, show weather info -->
    <div id="weather-info-view" style="display:none;">
        <div class="absolute medium-large-text" style="left: 100px; top: 130px; width: 40%;">
            <span class="lcars-purple-color"><span id="outsideTempSummary"></span> &deg;F / <span id="outsideHumiditySummary"></span> % Humidity<br/></span>
            <span class="lcars-blue-color">Precip Probability: <span id="precipProbabilitySummary"></span> % / Intensity: <span id="precipIntensitySummary"></span><br/></span>
            <span id="weatherSummarySummary" class="lcars-tan-color"></span><br/>
            <span id="weatherNextHourSummary" class="lcars-tan-color"></span><br/>
            <span class="lcars-red-color">Wind Speed: <span id="windSpeedSummary"></span> MPH</span>
        </div>
    </div>    

    <!--  'Left' button pressed, show locale info -->
    <div id="locale-info-view" style="display:none;">
        <div class="absolute medium-text" style="left: 100px; top: 130px; width: 70%;">
            <div id="address" class="lcars-blue-color"></div>
            <div id="area" class="lcars-purple-color"></div>
            <div id="city" class="lcars-blue-color"></div>
            <div id="country" class="lcars-tan-color"></div>
            <div id="county" class="lcars-tan-color"></div>
            <div id="zipcode" class="lcars-red-color"></div>
        </div>
    </div>    

    <!-- 'Right' button pressed, show full stats view -->    
    <div id="driving-stats-view" style="display:none;">
        <table id="driving-stats-table" class="absolute medium-text" style="left: 120px; top: 130px; width: 70%;">
            <tr>
                <td class="no-text-wrap">&nbsp;</td>
                <td class="no-text-wrap">Today</td>
                <td class="no-text-wrap">Week</td>
                <td class="no-text-wrap">Month</td>
            </tr>
            <tr>
                <td class="lcars-blue-color no-text-wrap">DRIVING</td>
                <td class="lcars-blue-color no-text-wrap"><span id="drivingTimes1"></span></td>
                <td class="lcars-blue-color no-text-wrap"><span id="drivingTimes2"></span></td>
                <td class="lcars-blue-color no-text-wrap"><span id="drivingTimes3"></span></td>
            </tr>
            <tr>
                <td class="lcars-red-color no-text-wrap">TRAFFIC</td>
                <td class="lcars-red-color no-text-wrap"><span id="inTrafficTimes1"></span></td>
                <td class="lcars-red-color no-text-wrap"><span id="inTrafficTimes2"></span></td>
                <td class="lcars-red-color no-text-wrap"><span id="inTrafficTimes3"></span></td>
            </tr>
            <tr>
                <td class="lcars-purple-color no-text-wrap">AVG SPEED</td>
                <td class="lcars-purple-color no-text-wrap"><span id="averageSpeeds1"></span></td>
                <td class="lcars-purple-color no-text-wrap"><span id="averageSpeeds2"></span></td>
                <td class="lcars-purple-color no-text-wrap"><span id="averageSpeeds3"></span></td>
            </tr>
            <tr>
                <td class="lcars-tan-color no-text-wrap">MILES</td>
                <td class="lcars-tan-color no-text-wrap"><span id="averageAltitude1"></span></td>
                <td class="lcars-tan-color no-text-wrap"><span id="averageAltitude2"></span></td>
                <td class="lcars-tan-color no-text-wrap"><span id="averageAltitude3"></span></td>
            </tr>
        </table>
    </div>    

    <!-- Default or 'Down' button pressed -->
    <div id="default-driving-view" style="display:block;">
        <table class="absolute large-text" style="left: 370px; top: 130px; width: 40%;">
            <tr>
                <td class="lcars-blue-color no-text-wrap" style="width: 170px;">DRIVING</td>
                <td class="lcars-blue-color"><span id="drivingTime" class="no-text-wrap">0 MIN</span></td>
            </tr>
            <tr>
                <td class="lcars-red-color no-text-wrap" style="width: 170px;">TRAFFIC</td>
                <td class="lcars-red-color"><span id="inTrafficTime" class="no-text-wrap">0 MIN</span></td>
            </tr>
            <tr>
                <td class="lcars-purple-color no-text-wrap" style="width: 170px;">AVG SPEED</td>
                <td class="lcars-purple-color"><span id="averageSpeed" class="no-text-wrap">0</span> MPH</td>
            </tr>
            <!--  TODO
            <tr>
                <td class="lcars-tan-color no-text-wrap" style="width: 170px;">MILES</td>
                <td class="lcars-tan-color"><span id="currentTripMiles" class="no-text-wrap">0</span> MILES</td>
            </tr>
            -->
        </table>
    </div>    
    
    <div id="phone-message-container" class="absolute medium-text"><div id="phoneMessage"></div></div>
    <span class="small-text" style="position: absolute; color: black; top: 400px; left: 250px;">Altitude <span id="altitude">0</span> ft</span>
    <span class="small-text" style="position: absolute; color: black; top: 400px; left: 380px;"><span id="latitude">0</span> / <span id="longitude">0</span></span>
    <span class="small-text" style="position: absolute; color: black; position: absolute; top: 400px; left: 165px;">CLB <span id="climb">0</span></span>
    <span class="small-text" style="position: absolute; color: black; position: absolute; top: 400px; left: 612px;">TRK <span id="track">0.0</span></span> 

  <!-- LCARS INTERFACE -->
  <div class="lcars-container" style="padding:0; margin:0;">
    <div class="lcars-row spaced">
      <div class="lcars-column u-1-8 lcars-elbow left bottom lcars-orange-bg"></div>
      <div class="lcars-column u-6-8 lcars-divider lcars-orange-tan-divide">
        <div class="lcars-row">
          <div class="lcars-column u-1-2">                  
          <span class="absolute lcars-tan-color" style="top: 35px;">SYSTEM TIME</span>
          <h1 class="absolute time-text" style="top: 42px;"><span id="time">00:00PM</span></h1>
          </div>
          <div class="lcars-column u-1-2">
          </div>
        </div>
      </div>
      <div class="lcars-column u-1-8 lcars-elbow right bottom lcars-tan-bg"></div>
    </div>
    <div class="lcars-row">
      <div class="lcars-column u-1-8">
        <ul class="lcars-menu">
          <li class="lcars-orange-bg"></li>
          <li class="lcars-orange-bg tall large-gap"></li>
          <li class="lcars-tan-bg"></li>
          <li class="lcars-tan-bg tall"></li>
          <li class="lcars-tan-bg"></li>
        </ul>
      </div>
      <div class="lcars-column u-6-8">
        <div class="lcars-row">
          <div class="lcars-column u-1-2">
            &nbsp;
          </div>
          <div class="lcars-column u-1-2">
            &nbsp;
          </div>
        </div>
      </div>
      <div class="lcars-column u-1-8">
        <ul class="lcars-menu right">
          <li class="lcars-tan-bg">&nbsp;</li>
          <li class="lcars-tan-bg tall large-gap">&nbsp;</li>
          <li class="lcars-orange-bg">&nbsp;</li>
          <li class="lcars-orange-bg tall" style="position: relative;"><span class="micro-text" style="position: absolute; bottom: 0; font-weight: 100;">WIND <span id="windSpeed">0</span> MPH<br/>RAIN <span id="precipProbability">0</span>%</span></li>
          <li class="lcars-orange-bg"><span class="micro-text" style="font-weight: 100;">INT <span id="precipIntensity"></span></span></li>
        </ul>
      </div>
    </div>
    <div class="lcars-row spaced">
      <div class="lcars-column u-1-8 lcars-elbow left top lcars-tan-bg"></div>
      <div class="lcars-column u-6-8 lcars-divider bottom lcars-tan-orange-divide">
        <div class="lcars-row">
          <div class="lcars-column u-1-2"></div>
          <div class="lcars-column u-1-2"></div>
        </div>
      </div>
      <div class="lcars-column u-1-8 lcars-elbow right top lcars-orange-bg"></div>
    </div>
  </div>

 <script type="text/javascript">
 
      // each second update the LCARS UI with the GPS known data
      $(document).ready(function() {
          setInterval(function() {
            $.get( "/computer/TripStats.py", function( data ) {
                var data = JSON.parse(data);
                
                // rotate the compass the number of degress
                rotateCompass( data.track , data.speed );
          
                // populate known GPS data
                $( "#speed" ).html( data.speed );
                
                // if the speed is above 5 we can accurately display the direction
                if (data.speed > 5) {
                    $( "#tracking" ).html( data.tracking );
                }
                $( "#track" ).html( data.track );
                $( "#climb" ).html( data.climb );
                $( "#latitude" ).html( data.latitude );
                $( "#longitude" ).html( data.longitude );
                $( "#altitude" ).html( data.altitude );
            });
          }, 1000);
      });
 
     // each second update the LCARS UI with the Inside temp and internet connected data data 
      $(document).ready(function() {
          setInterval(function() {
            $.get( "/computer/TripStats.py", function( data ) {
                var data = JSON.parse(data);
               
                // based on button pressed, hide or show elements on the output screen
                var buttonPressed = data.buttonPressed;
                $( "#heading-info" ).show();
                $( "#weather-info-view" ).hide();
                $( "#locale-info-view" ).hide();
                $( "#driving-stats-view" ).hide();
                $( "#default-driving-view" ).hide();
                
                if ( buttonPressed == 'Down' ) {
                    $( "#default-driving-view" ).show();
                } else if ( buttonPressed == 'Up' ) {
                    $( "#heading-info" ).hide();
                    $( "#weather-info-view" ).show();
                } else if ( buttonPressed == 'Left' ) {
                    $( "#heading-info" ).hide();
                    $( "#locale-info-view" ).show();
                } else if ( buttonPressed == 'Right' ) {
                    $( "#heading-info" ).hide();
                    $( "#driving-stats-view" ).show();
                }

                // populate inside temp/humidity
                $( "#insideHumidity" ).html( data.insideHumidity );
                $( "#insideTemp" ).html( data.insideTemp );

                // check that the internet is connected                
                var internetConnected = data.internetConnected;
                if (internetConnected == "ok") {
                    $( "#internetConnected" ).html( "connected" );
                    $( "#time" ).html( data.time );
                    
                    // show phone message if one is present and we're connected to the internet
                    if (data.phoneMessage != '') {
                        $( "#phoneMessage" ).html( data.phoneMessage );
                    } else {
                        $( "#phoneMessage" ).html( "" );
                    }   
                } else {
                    $( "#internetConnected" ).html( "offline" );
                    $( "#phoneMessage" ).html( " - Internet Offline - " );
                    $( "#time" ).html( "00:00PM" );
                }
            });
          }, 1000);
      });
 
     // each second update the LCARS UI with the outside weather data 
      $(document).ready(function() {
          setInterval(function() {
            $.get( "/computer/TripStats.py", function( data ) {
                var data = JSON.parse(data);
                
                 // complete weather info
                $( "#outsideHumiditySummary" ).html( data.outsideHumidity );
                $( "#outsideTempSummary" ).html( data.outsideTemp );
                $( "#precipIntensitySummary" ).html( data.precipIntensity );
                $( "#precipProbabilitySummary" ).html( data.precipProbability );
                $( "#weatherNextHourSummary" ).html( data.weatherNextHour );
                $( "#weatherSummarySummary" ).html( data.weatherSummary );
                $( "#windSpeedSummary" ).html( data.windSpeed );
            
                // populate known weather info
                $( "#weatherNextHour" ).html( data.weatherNextHour.substring(0, 30) );
                $( "#weatherSummary" ).html( data.weatherSummary );
                $( "#windSpeed" ).html( data.windSpeed );
                $( "#outsideTemp" ).html( data.outsideTemp );
                $( "#outsideHumidity" ).html( data.outsideHumidity );
                $( "#precipIntensity" ).html( data.precipIntensity );
                $( "#precipProbability" ).html( data.precipProbability );
            });
          }, 10000);
      });
 
     // each 5 seconds update the LCARS UI with the current location found data 
      $(document).ready(function() {
          setInterval(function() {
            $.get( "/computer/TripStats.py", function( data ) {
                var data = JSON.parse(data);
                // complete locale info
                $( "#address" ).html( data.address );
                $( "#area" ).html( data.area );
                $( "#city" ).html( data.city );
                $( "#country" ).html( data.country );
                $( "#county" ).html( data.county );
                $( "#zipcode" ).html( data.zipcode );
            });
          }, 10000);
      });
 
     // each second update the LCARS UI with the trip averages data 
      $(document).ready(function() {
          setInterval(function() {
            $.get( "/computer/TripStats.py", function( data ) {
                var data = JSON.parse(data);
                // current trip stats
                $( "#averageSpeed" ).html( data.averageSpeed );
                $( "#drivingTime" ).html( data.drivingTime );
                $( "#inTrafficTime" ).html( data.inTrafficTime );
                
                // populate altitude history
                $( "#averageAltitude1" ).html( data.averageAltitude[1] );
                $( "#averageAltitude2" ).html( data.averageAltitude[2] );
                $( "#averageAltitude3" ).html( data.averageAltitude[3] );
            
                // populate speed history
                $( "#averageSpeeds1" ).html( data.averageSpeeds[1] );
                $( "#averageSpeeds2" ).html( data.averageSpeeds[2] );            
                $( "#averageSpeeds3" ).html( data.averageSpeeds[3] );
                
                // populate driving times
                $( "#drivingTimes1" ).html( data.drivingTimes[1] );
                $( "#drivingTimes2" ).html( data.drivingTimes[2] );
                $( "#drivingTimes3" ).html( data.drivingTimes[3] );

                // populate traffic times
                $( "#inTrafficTimes1" ).html( data.inTrafficTimes[1] );
                $( "#inTrafficTimes2" ).html( data.inTrafficTimes[2] );
                $( "#inTrafficTimes3" ).html( data.inTrafficTimes[3] );               
            });
          }, 10000);
      });
 
     // each second update the LCARS UI with the miles travelled data 
      $(document).ready(function() {
          setInterval(function() {
            $.get( "/computer/TripStats.py", function( data ) {
                var data = JSON.parse(data);
                // populate miles travelled
                //$( "#currentTripMiles" ).html( data.tripMilesTravelled ); 
                $( "#milesTravelled1" ).html( data.milesTravelled[1] );
                $( "#milesTravelled2" ).html( data.milesTravelled[2] );
                $( "#milesTravelled3" ).html( data.milesTravelled[3] );
            });
          }, 10000);
      });
      
     // rotate the compass image by arbitrary degrees but only if we're actually moving for correct GPS readings
     function rotateCompass(deg, speed) {
        if (speed > 5) {
            deg = -deg;
            $( "#compass" ).css({"-webkit-transform": "rotate("+deg+"deg)","-moz-transform": "rotate("+deg+"deg)","transform": "rotate("+deg+"deg)"});
        }
     }
  </script>
</body>
</html>
