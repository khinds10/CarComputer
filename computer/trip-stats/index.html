<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LCARS</title>
  <link rel="stylesheet" href="css/lcars.min.css">
  <style>

    @font-face {
        font-family: lcars; src: url('font/lcars.otf');
    }
    
    html, body {
        background: black;
        font-family: lcars;
        width: 800px; 
        height: 480px; 
        border: solid 1px #FFF;
    }

    .absolute {
        position: absolute;
    }

    .black {
        color: black;
    }

    .background-text {
        font-size: 25px;
    }

    .medium-text {
        font-size: 32px;
    }

    .medium-large-text {
        font-size: 35px;
    }

    .large-text {
        font-size: 40px;
    }

    .time-text {
        font-size: 55px;
    }
  </style>
  <script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
</head>
<body>
    <!-- DATA ELEMENTS -->
    <span class="absolute black background-text" style="top: 10px; left: 270px;">WIFI</span>
    <span class="absolute black background-text" style="top: 10px; left: 450px;"><span id="weatherSummary"></span></span>
    <h3 class="lcars-red-color absolute medium-large-text" style="top: 360px; left: 270px;"><span id="speed">0</span> MPH</h3>
    <span class="lcars-tan-color absolute" style="top: 40px;  left: 370px;">EXTERIOR</span>
    <strong class="lcars-purple-color medium-text absolute" style="top: 55px; left: 370px;"><span id="outsideTemp">0</span>&deg;F / <span id="outsideHumidity">0</span>%</strong>
    <span class="lcars-tan-color absolute" style="top: 40px; left: 540px;">INTERIOR</span>
    <strong class="lcars-red-color medium-text absolute" style="top: 55px; left: 540px;"><span id="insideTemp">0</span>&deg;F / <span id="insideHumidity">0</span>%</strong>
    <span class="lcars-tan-color absolute" style="top: 98px; left: 370px;">STATISTICS</span>
    <span class="lcars-tan-color absolute" style="top: 150px; left: 100px;">HEADING</span>
    <span class="lcars-tan-color absolute" style="top: 150px; left: 100px;"><img id="compass" src="img/compass.png" style="width:220px;"/></span>
    <strong class="absolute lcars-purple-color medium-large-text" style="top: 360px; left: 120px;"><span id="tracking"></span></strong>
    <table class="absolute large-text" style="left: 370px; top: 110px; width: 40%;">
        <tr>
            <td class="lcars-blue-color" style="width: 170px;">DRIVING</td>
            <td class="lcars-blue-color"><span id="drivingTime">1 MIN</span></td>
        </tr>
        <tr>
            <td class="lcars-red-color" style="width: 170px;">TRAFFIC</td>
            <td class="lcars-red-color"><span id="inTrafficTime">0 MIN</span></td>
        </tr>
        <tr>
            <td class="lcars-purple-color" style="width: 170px;">AVG SPEED</td>
            <td class="lcars-purple-color"><span id="averageSpeed">0</span> MPH</td>
        </tr>
        <tr>
            <td colspan="2"><i class="medium-text"><span id="weatherNextHour"></span></i></td>
        </tr>
    </table>
     <div class="absolute medium-text" style="left: 370px; top: 300px; width: 320px; height: 92px;  overflow: hidden;"><div id="phoneMessage"></div></div>
    <span style="font-size: 25px; position: absolute; color: black; top: 410px; left: 250px;">Altitude <span id="altitude">0</span> ft</span>
    <span style="font-size: 25px; position: absolute; color: black; top: 410px; left: 410px;"><span id="latitude">0</span> / -<span id="longitude">0</span></span>
    <span style="font-size: 25px; position: absolute; color: black; position: absolute; top: 410px; left: 165px;">CLB <span id="climb">0</span></span>
    <span style="font-size: 25px; position: absolute; color: black; position: absolute; top: 410px; left: 622px;">TRK <span id="track">0.0</span></span> 

  <!-- LCARS INTERFACE -->
  <div class="lcars-container">
    <div class="lcars-row spaced">
      <div class="lcars-column u-1-8 lcars-elbow left bottom lcars-orange-bg"></div>
      <div class="lcars-column u-6-8 lcars-divider lcars-orange-tan-divide">
        <div class="lcars-row">
          
          <div class="lcars-column u-1-2">                  
          <span class="absolute lcars-tan-color" style="top: 35px;">SYSTEM TIME</span>
          <h1 class="absolute time-text" style="top: 42px;"><span id="time">00:00PM</span></h1>
          </div>
          <div class="lcars-column u-1-2">
          </div>
        </div>
      </div>
      <div class="lcars-column u-1-8 lcars-elbow right bottom lcars-tan-bg"></div>
    </div>
    <div class="lcars-row">
      <div class="lcars-column u-1-8">
        <ul class="lcars-menu">
          <li class="lcars-orange-bg"></li>
          <li class="lcars-orange-bg tall large-gap"></li>
          <li class="lcars-tan-bg"></li>
          <li class="lcars-tan-bg tall"></li>
          <li class="lcars-tan-bg"></li>
        </ul>
      </div>
      <div class="lcars-column u-6-8">
        <div class="lcars-row">
          <div class="lcars-column u-1-2">
            &nbsp;
          </div>
          <div class="lcars-column u-1-2">
            &nbsp;
          </div>
        </div>
      </div>
      <div class="lcars-column u-1-8">
        <ul class="lcars-menu right">
          <li class="lcars-tan-bg">&nbsp;</li>
          <li class="lcars-tan-bg tall large-gap">&nbsp;</li>
          <li class="lcars-orange-bg">&nbsp;</li>
          <li class="lcars-orange-bg tall" style="position: relative;"><span style="font-size: 20px; position: absolute; bottom: 0;">WIND<span id="windSpeed">0</span> MPH<br/>RAIN <span id="precipProbability">0</span>%</span></li>
          <li class="lcars-orange-bg"><span style="font-size: 20px;">INT <span id="precipIntensity"></span></span></li>
        </ul>
      </div>
    </div>
    <div class="lcars-row spaced">
      <div class="lcars-column u-1-8 lcars-elbow left top lcars-tan-bg"></div>
      <div class="lcars-column u-6-8 lcars-divider bottom lcars-tan-orange-divide">
        <div class="lcars-row">
          <div class="lcars-column u-1-2"></div>
          <div class="lcars-column u-1-2"></div>
        </div>
      </div>
      <div class="lcars-column u-1-8 lcars-elbow right top lcars-orange-bg"></div>
    </div>
  </div>
  
  <!-- 
    TODO
    <span id="drivingTimes1">--</span>
    <span id="drivingTimes2">--</span>
    <span id="drivingTimes3">--</span>
    <span id="inTrafficTimes1">--</span>
    <span id="inTrafficTimes2">--</span>
    <span id="inTrafficTimes3">--</span>
    <span id="averageSpeeds1">--</span> mph
    <span id="averageSpeeds2">--</span> mph
    <span id="averageSpeeds3">--</span> mph
    <span id="milesTravelled1">--</span>
    <span id="milesTravelled2">--</span>
    <span id="milesTravelled3">--</span>
    <span id="averageAltitude1">--</span> ft
    <span id="averageAltitude2">--</span> ft
    <span id="averageAltitude3">--</span> ft
    <span id="localeInfo">--</span>
    <span id="currentTripTime">--</span>
  -->
  
 <script type="text/javascript">
 
     // each second update the LCARS UI with the new data 
      $(document).ready(function(){
          setInterval(function(){
            $.get( "/computer/TripStats.py", function( data ) {
                var data = JSON.parse(data);
                console.log(data);
                
                // populate all the fields with data
                $( "#time" ).html( data.time );
                $( "#outsideTemp" ).html( data.outsideTemp );
                $( "#insideHumidity" ).html( data.insideHumidity );            
                $( "#insideTemp" ).html( data.insideTemp );
                $( "#localeInfo" ).html( data.localeInfo );
                $( "#outsideHumidity" ).html( data.outsideHumidity );
                $( "#precipIntensity" ).html( data.precipIntensity );
                $( "#precipProbability" ).html( data.precipProbability );
                $( "#tracking" ).html( data.tracking );
                $( "#track" ).html( data.track );
                $( "#climb" ).html( data.climb );
                $( "#latitude" ).html( data.latitude );
                $( "#longitude" ).html( data.longitude );
                $( "#weatherNextHour" ).html( data.weatherNextHour.substring(0, 30) );
                $( "#weatherSummary" ).html( data.weatherSummary );
                $( "#windSpeed" ).html( data.windSpeed );
                $( "#altitude" ).html( data.altitude );
                $( "#speed" ).html( data.speed );
                
                // current trip stats
                $( "#averageSpeed" ).html( data.averageSpeed );
                $( "#drivingTime" ).html( data.drivingTime );
                $( "#inTrafficTime" ).html( data.inTrafficTime );
                $( "#currentTripTime" ).html( data.tripMilesTravelled ); 
                 
                // populate altitude history
                $( "#averageAltitude1" ).html( data.averageAltitude[1] );
                $( "#averageAltitude2" ).html( data.averageAltitude[2] );
                $( "#averageAltitude3" ).html( data.averageAltitude[3] );
            
                // populate speed history
                $( "#averageSpeeds1" ).html( data.averageSpeeds[1] );
                $( "#averageSpeeds2" ).html( data.averageSpeeds[2] );            
                $( "#averageSpeeds3" ).html( data.averageSpeeds[3] );
                
                // populate driving times
                $( "#drivingTimes1" ).html( data.drivingTimes[1] );
                $( "#drivingTimes2" ).html( data.drivingTimes[2] );
                $( "#drivingTimes3" ).html( data.drivingTimes[3] );

                // populate traffic times
                $( "#inTrafficTimes1" ).html( data.inTrafficTimes[1] );
                $( "#inTrafficTimes2" ).html( data.inTrafficTimes[2] );
                $( "#inTrafficTimes3" ).html( data.inTrafficTimes[3] );
                
                // populate miles travelled
                //$( "#milesTravelled1" ).html( data.milesTravelled[1] );
                //$( "#milesTravelled2" ).html( data.milesTravelled[2] );
                //$( "#milesTravelled3" ).html( data.milesTravelled[3] );
                
                // show phone message if one is present
                if (data.phoneMessage != '') {
                    $( "#phoneMessage" ).html( data.phoneMessage );
                } else {
                    $( "#phoneMessage" ).html( "" );                
                }
                
                // rotate the compass the number of degress
                rotateCompass(data.track);
            });
          }, 1000);
      });
      
     // rotate the compass image by arbitrary degrees
     function rotateCompass(deg) {
            deg = -deg;
            $( "#compass" ).css({"-webkit-transform": "rotate("+deg+"deg)","-moz-transform": "rotate("+deg+"deg)","transform": "rotate("+deg+"deg)"});
     }
  </script>
</body>
</html>
